---
title: "Title of Your Report"
author: "Names of your Group Members"
date: "Due Date"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

## Title of your Report

# Name(s) of Author(s) 
# Date

## Abstract

Here is where you give a brief (one paragraph overview of your entire paper). This should include some background/introduction, some methodology, results and conclusions.

## Introduction

Here is where you should give insight into the setting and introduce the goal of the analysis. Here you can introduce ideas and basic concepts regarding the study setting and the potential model. Again, this is the introduction, so you should be explaining the importance of the work that is ahead and hopefully build some suspense for the reader. You can also highlight what will be included in the subsequent sections.

## Data
Our main data requirements are an individual first marriage age and family income and having the first child age. We use dataset from General social survey on Family (cycle 31), 2017. In order to better do analysis on the dataset, we use gss_cleaning.R to clean the data and analyze on the cleaned data.  
The data has 20,602 sample size so it should be big enough to representativly reflect the relationship between of first marriage age and having the first child age.  
A potential drawback is 2017 is 

```{r warning=FALSE, message=FALSE}
library(tidyverse)
gss_data = read_csv("gss.csv")


#note here we create a new column income: the higher income is,the higher the income family is 
cleaned_gss_data = gss_data %>% 
  select(age_at_first_birth, income_family,age_at_first_marriage) %>% 
  mutate(income = case_when(income_family == "Less than $25,000" ~ 0,
                                      income_family == "$25,000 to $49,999" ~ 1, 
                                       income_family == "$50,000 to $74,999" ~ 2, 
                                       income_family == "$75,000 to $99,999" ~ 3, 
                                       income_family == "$100,000 to $ 124,999" ~ 4, 
                                       income_family == "$125,000 and more" ~5 ))

lmod <- lm(age_at_first_birth ~  age_at_first_marriage + income,
                 data=cleaned_gss_data)

```

## Model

We use a multiple regression model based on (+ reference) in order to find if first birth age has some relationship with first marriage age and income.\\

Our fitted model is $Birth_i = \hat{\beta_0}  + \hat{\beta_1}Marriage_i + \hat{\beta_2}Income_i, i=1,2,...,N$ where i stands for each individual.  
Marriage_i (in years) means the first marriage age of the individual i. Income_i means the income level of individual i. (We define income_i in the range [1,5]. The higher income_i is, the higher income of individual i's family). Birth_i (in years) means having the first child age of the individual i. 
 
$\hat{\beta_0}$ is meaningless in our scenario since there is no meaning to analyze a individual marriage at age 0.
$\hat{\beta_1}$ means the changes of the having the first child age (in years) when the fist marriage age increase by 1 year.   
$\hat{\beta_2}$ means the changes of the having the first child age (in years) when the Income increase by 1.  

The software We use to run the model is RStudio.    

summary(lmod)

plot(cleaned_gss_data[c(1,3,4)])



## Results
There is the Scattor Plot of Ages of Having First Child and First Marriage and Income:  
```{r warning=FALSE, message=FALSE}
plot(cleaned_gss_data[c(1,3,4)], main = "Figure 1: Scatter plot of analysis")

```


The following is our model summary:  
```{r  include = FALSE}
summary(lmod)
```

\begin{table}[h!]
  \begin{center}
    \caption{Summary of the Parameters of SLR Model}
      \begin{tabular}{|c|c|c|c|c|}
        \hline
         Coefficients & Estimate & Std. Error & t value & Pr($>|t|$)\\
         \hline
         $\beta_0$ & 8.02553 & 0.32972 & 24.34 & <2e-16 \\
         $\beta_1$ & 0.71305 & 0.01396 & 51.06 & <2e-16 \\
         $\beta_2$ & 0.44157 & 0.03916 & 11.28 & <2e-16 \\
         \hline
        \end{tabular}
  \end{center}
\end{table}

Then we diagnose if the simple linear regression model is appropriate.  
```{r warning=FALSE, message=FALSE}
par(mfrow=c(2,2))
plot(lmod, main= "Figure 2: Plots about Residuals")
```


## Discussion
From Figure 1, we could see there is a positive linear trend between ages of having first child and fist marriage.   
From Table 1, we could see the p value of the estimates of $\beta_1$ and $\beta_2$ is very small, which means there is strong evidence to reject that there are no linear realtionships between ages of having first child and fist marriage and between age of first child and income.  
We diagnose the mutliple regression model in Figure 3. From those residual plots, we could see the model is not that perfect since there are some bad leverage points, and the standardized residuals does not show a perfect normal distribution, and the Resiudals vs Fitted plot shows a little pattern. However, the model is still alomst approximate since it does not break the rule much. In addition,the Multiple R-squared value is 0.4193 which can be seen from Table 1, this value represents the variance explained by our model. It is not bad.  

From Table 1, we get our fitted line is $Birth_i = 8.02553  + 0.71305Marriage_i + 0.44157Income_i, i=1,2,...,N$. Since $\hat{\beta_0}$ and $\hat{\beta_1}$ both positive, we could see as the age of marriage increses, the age of having first child increase, and as the income increses,the age of having first child increases. Since $\hat{\beta_0} > \hat{\beta_1}$, the age of marrige tend to have a bigger influence on the age of having first child.  

Maybe rich people do not tend to have child later but this also might due to the reason that richer people tend to be older, we need to do further analysize on this.





# Weaknesses

Here we discuss weaknesses of the study, data, analysis, etc. You can also discuss areas for improvement.

# Next Steps

Here you discuss subsequent work to be done after this report. This can include next steps in terms of statistical analysis (perhaps there is a more efficient algorithm available, or perhaps there is a caveat in the data that would allow for some new technique). Future steps should also be specified in terms of the study setting (eg. including a follow-up survey on something, or a subsequent study that would complement the conclusions of your report).


## References
1. Wu, Changbao, and Mary E. Thompson. "Basic Concepts in Survey Sampling." Sampling Theory and Practice. Springer, Cham, 2020. 3-15.







