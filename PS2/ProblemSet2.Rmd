---
title: "Title of Your Report"
author: "Names of your Group Members"
date: "Due Date"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

## Title of your Report

# Name(s) of Author(s) 
# Date

## Abstract

Here is where you give a brief (one paragraph overview of your entire paper). This should include some background/introduction, some methodology, results and conclusions.

## Introduction

Here is where you should give insight into the setting and introduce the goal of the analysis. Here you can introduce ideas and basic concepts regarding the study setting and the potential model. Again, this is the introduction, so you should be explaining the importance of the work that is ahead and hopefully build some suspense for the reader. You can also highlight what will be included in the subsequent sections.

## Data
Our main data requirements are an individual first marriage age and having the first child age. We use dataset from General social survey on Family (cycle 31), 2017. In order to better do analysis on the dataset, we use gss_cleaning.R to clean the data and analyze on the cleaned data.  
The data has 20,602 sample size so it should be big enough to representativly reflect the relationship between of first marriage age and having the first child age.  
A potential drawback is 2017 is 

```{r warning=FALSE, message=FALSE}
library(tidyverse)
gss_data = read_csv("gss.csv")

#get the no NA's analyzing data
#age_at_first_marriage -> x
#age_at_first_birth -> y (the age when having the first child)
cleaned_gss_data = gss_data %>% 
  filter(!is.na(age_at_first_marriage) & !is.na(age_at_first_birth)) %>%  
  select(age_at_first_birth, age_at_first_marriage) 
```

## Model

Introduce the selected model here. It is expected that you will use some mathematical notation here. If you do please ensure that all notation is explained. You may also want to discuss any special (hypothetical) cases of your model here, as well as any caveats.



We used a simple linear regression model with an intercept based on (+ reference). 
$y_i = \beta_0  + \beta_1x_i + \epsilon_i, i=1,2,...,N$ 
where i stands for each individual.$x_i$ means the first marriage age of the individual i.$y_i$ means having the first child age of the individual i. 
$\beta_1$ means the average change of the having the first child age (in years) when the fist marriage age increase by 1 year.  
$\beta_0$ is meaningless in our scenario since there is no meaning to analyze a individual marriage at age 0.  
$\epsilon_1,... ,\epsilon_N$ are independent error terms with the expecation $E_{\epsilon}(\epsilon_i) = 0$ and the variance $V_{\epsilon}(\epsilon_i) = \sigma^2$.  


We use $\hat{y}= b_0 + b_1x$ to fit the model where x is the first marriage of a individual and $
$\hat{y}$ is the fitted age when having the first child. $b_0$ and $b_1$ is an unbiased estimates of the parameter $\beta_0$ and $\beta_1$ in the above model respectively.

The software I use to run the model is RStudio. To use the simple linear regression model, we need the model description about $\epsilon$ holds. We will use the      

```{r warning=FALSE, message=FALSE}
# fit the Simple linear regression model
lmod <- lm(age_at_first_birth ~ age_at_first_marriage,
                 data=cleaned_gss_data)
```



## Results
There is the Scattor Plot of Ages of Having First Child and First Marriage:  
```{r warning=FALSE, message=FALSE}
cleaned_gss_data %>% 
  ggplot(aes(x=age_at_first_marriage,y=age_at_first_birth))+
  geom_point()+geom_smooth(method=lm) + 
  labs(x = "Age of First Marriage",
       y = "Age of having first child",
       title = "Figure 1:Scatter Plot of Ages of Having First Child and First Marriage")
```


The following is our model summary:  
```{r  include=FALSE}
summary(lmod)
```

\begin{table}[h!]
  \begin{center}
    \caption{Summary of the Parameters of SLR Model}
      \begin{tabular}{|c|c|c|c|c|}
        \hline
         Coefficients & Estimate & Std. Error & t value & Pr($>|t|$)\\
         \hline
         $\beta_0$ & 8.38083 & 0.33329 & 25.15& <2e-16 \\
         $\beta_1$ & 0.73254 & 0.01407& 52.06 & <2e-16 \\
         \hline
        \end{tabular}
  \end{center}
\end{table}

Then we diagnose if the simple linear regression model is appropriate.  
```{r warning=FALSE, message=FALSE}
cleaned_gss_data %>% 
  ggplot(aes(x= age_at_first_birth)) + 
  geom_histogram() +
  labs(x = "Age of having first child",
      title="Figure 2:Histogram of Age when Having the First Child")
  
qqnorm(cleaned_gss_data$age_at_first_birth, main="Figure 3:Normal QQ Plot of Age when Having the First Child: ", cex=0.5)
qqline(cleaned_gss_data$age_at_first_birth)
```


## Discussion

Here you will discuss conclusions drawn from the results and comment on how it relates to the original goal of the study (which was specified in the Introduction).

# Weaknesses

Here we discuss weaknesses of the study, data, analysis, etc. You can also discuss areas for improvement.

# Next Steps

Here you discuss subsequent work to be done after this report. This can include next steps in terms of statistical analysis (perhaps there is a more efficient algorithm available, or perhaps there is a caveat in the data that would allow for some new technique). Future steps should also be specified in terms of the study setting (eg. including a follow-up survey on something, or a subsequent study that would complement the conclusions of your report).


## References
1. Wu, Changbao, and Mary E. Thompson. "Basic Concepts in Survey Sampling." Sampling Theory and Practice. Springer, Cham, 2020. 3-15.



